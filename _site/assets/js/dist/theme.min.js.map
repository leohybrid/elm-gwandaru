{"version":3,"file":"theme.min.js","sources":["../../../_javascript/theme.js"],"sourcesContent":["/**\r\n * Theme management class\r\n *\r\n * To reduce flickering during page load, this script should be loaded synchronously.\r\n */\r\nclass Theme {\r\n  static #modeKey = 'mode';\r\n  static #modeAttr = 'data-mode';\r\n  static #darkMedia = window.matchMedia('(prefers-color-scheme: dark)');\r\n  static switchable = !document.documentElement.hasAttribute(this.#modeAttr);\r\n\r\n  static get DARK() {\r\n    return 'dark';\r\n  }\r\n\r\n  static get LIGHT() {\r\n    return 'light';\r\n  }\r\n\r\n  /**\r\n   * @returns {string} Theme mode identifier\r\n   */\r\n  static get ID() {\r\n    return 'theme-mode';\r\n  }\r\n\r\n  /**\r\n   * Gets the current visual state of the theme.\r\n   *\r\n   * @returns {string} The current visual state, either the mode if it exists,\r\n   *                   or the system dark mode state ('dark' or 'light').\r\n   */\r\n  static get visualState() {\r\n    if (this.#hasMode) {\r\n      return this.#mode;\r\n    } else {\r\n      return this.#sysDark ? this.DARK : this.LIGHT;\r\n    }\r\n  }\r\n\r\n  static get #mode() {\r\n    return (\r\n      sessionStorage.getItem(this.#modeKey) ||\r\n      document.documentElement.getAttribute(this.#modeAttr)\r\n    );\r\n  }\r\n\r\n  static get #isDarkMode() {\r\n    return this.#mode === this.DARK;\r\n  }\r\n\r\n  static get #hasMode() {\r\n    return this.#mode !== null;\r\n  }\r\n\r\n  static get #sysDark() {\r\n    return this.#darkMedia.matches;\r\n  }\r\n\r\n  /**\r\n   * Maps theme modes to provided values\r\n   * @param {string} light Value for light mode\r\n   * @param {string} dark Value for dark mode\r\n   * @returns {Object} Mapped values\r\n   */\r\n  static getThemeMapper(light, dark) {\r\n    return {\r\n      [this.LIGHT]: light,\r\n      [this.DARK]: dark\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Initializes the theme based on system preferences or stored mode\r\n   */\r\n  static init() {\r\n    if (!this.switchable) {\r\n      return;\r\n    }\r\n\r\n    this.#darkMedia.addEventListener('change', () => {\r\n      const lastMode = this.#mode;\r\n      this.#clearMode();\r\n\r\n      if (lastMode !== this.visualState) {\r\n        this.#notify();\r\n      }\r\n    });\r\n\r\n    if (!this.#hasMode) {\r\n      return;\r\n    }\r\n\r\n    if (this.#isDarkMode) {\r\n      this.#setDark();\r\n    } else {\r\n      this.#setLight();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Flips the current theme mode\r\n   */\r\n  static flip() {\r\n    if (this.#hasMode) {\r\n      this.#clearMode();\r\n    } else {\r\n      this.#sysDark ? this.#setLight() : this.#setDark();\r\n    }\r\n    this.#notify();\r\n  }\r\n\r\n  static #setDark() {\r\n    document.documentElement.setAttribute(this.#modeAttr, this.DARK);\r\n    sessionStorage.setItem(this.#modeKey, this.DARK);\r\n  }\r\n\r\n  static #setLight() {\r\n    document.documentElement.setAttribute(this.#modeAttr, this.LIGHT);\r\n    sessionStorage.setItem(this.#modeKey, this.LIGHT);\r\n  }\r\n\r\n  static #clearMode() {\r\n    document.documentElement.removeAttribute(this.#modeAttr);\r\n    sessionStorage.removeItem(this.#modeKey);\r\n  }\r\n\r\n  /**\r\n   * Notifies other plugins that the theme mode has changed\r\n   */\r\n  static #notify() {\r\n    window.postMessage({ id: this.ID }, '*');\r\n  }\r\n}\r\n\r\nTheme.init();\r\n\r\nexport default Theme;\r\n"],"names":["Theme","_classCallCheck","_createClass","key","get","_classPrivateGetter","this","_get_hasMode","_get_mode","_get_sysDark","DARK","LIGHT","value","light","dark","_defineProperty","_this5","switchable","_assertClassBrand","_darkMedia","_","addEventListener","lastMode","_clearMode","call","visualState","_notify","_get_isDarkMode","_setDark","_setLight","_this","sessionStorage","getItem","_modeKey","document","documentElement","getAttribute","_modeAttr","_this2","_this3","_this4","matches","setAttribute","setItem","removeAttribute","removeItem","window","postMessage","id","ID","_Theme","matchMedia","hasAttribute","init"],"mappings":"8FAKMA,EAAK,WAAA,SAAAA,IAAAC,OAAAD,EAAA,CAAA,OAAAE,EAAAF,EAAA,KAAA,CAAA,CAAAG,IAAA,OAAAC,IAMT,WACE,MAAO,MACT,GAAC,CAAAD,IAAA,QAAAC,IAED,WACE,MAAO,OACT,GAEA,CAAAD,IAAA,KAAAC,IAGA,WACE,MAAO,YACT,GAEA,CAAAD,IAAA,cAAAC,IAMA,WACE,OAAIC,EA5BFL,EA4BEM,KAAKC,GACAF,EA7BPL,EA6BOM,KAAKE,GAELH,EA/BPL,EA+BOM,KAAKG,GAAWH,KAAKI,KAAOJ,KAAKK,KAE5C,GAAC,CAAAR,IAAA,iBAAAS,MA2BD,SAAsBC,EAAOC,GAC3B,OAAAC,EAAAA,EAAA,CAAA,EACGT,KAAKK,MAAQE,GACbP,KAAKI,KAAOI,EAEjB,GAEA,CAAAX,IAAA,OAAAS,MAGA,WAAc,IAAAI,EAAAV,KACPA,KAAKW,aAIVC,EA3EElB,EA2EFM,KAAKa,GAAUC,EAACC,iBAAiB,SAAU,WACzC,IAAMC,EAAWjB,EA5EjBL,EA4EiBgB,EAAKR,GACtBU,EA7EAlB,EA6EAgB,EAAKO,GAAUC,KAAfR,GAEIM,IAAaN,EAAKS,aACpBP,EAhFFlB,EAgFEgB,EAAKU,GAAOF,KAAZR,EAEJ,GAEKX,EApFHL,EAoFGM,KAAKC,KAINF,EAxFFL,EAwFEM,KAAKqB,GACPT,EAzFAlB,EAyFAM,KAAKsB,GAAQJ,KAAblB,MAEAY,EA3FAlB,EA2FAM,KAAKuB,GAASL,KAAdlB,OAEJ,GAEA,CAAAH,IAAA,OAAAS,MAGA,WACMP,EAnGFL,EAmGEM,KAAKC,GACPW,EApGAlB,EAoGAM,KAAKiB,GAAUC,KAAflB,MAEAD,EAtGAL,EAsGAM,KAAKG,GAAWS,EAtGhBlB,EAsGgBM,KAAKuB,GAASL,KAAdlB,MAAmBY,EAtGnClB,EAsGmCM,KAAKsB,GAAQJ,KAAblB,MAErCY,EAxGElB,EAwGFM,KAAKoB,GAAOF,KAAZlB,KACF,IAAC,CAzGQ,GAAA,SAAAE,EAAAsB,GAoCP,OACEC,eAAeC,QAAQd,EArCvBlB,EAAK8B,EAqCuBG,GAAQb,IACpCc,SAASC,gBAAgBC,aAAalB,EAtCtClB,EAAK8B,EAsCsCO,GAASjB,EAExD,CAAC,SAAAO,EAAAW,GAGC,OAAOjC,EA3CLL,EAAKsC,EA2CK9B,KAAU8B,EAAK5B,IAC7B,CAAC,SAAAH,EAAAgC,GAGC,OAAsB,OAAflC,EA/CLL,EAAKuC,EA+CK/B,EACd,CAAC,SAAAC,EAAA+B,GAGC,OAAOtB,EAnDLlB,EAAKwC,EAmDKrB,GAAUC,EAACqB,OACzB,CAAC,SAAAb,IAwDCM,SAASC,gBAAgBO,aAAaxB,EA5GpClB,EA4GoCM,KAAK+B,GAASjB,EAAEd,KAAKI,MAC3DqB,eAAeY,QAAQzB,EA7GrBlB,EA6GqBM,KAAK2B,GAAQb,EAAEd,KAAKI,KAC7C,CAAC,SAAAmB,IAGCK,SAASC,gBAAgBO,aAAaxB,EAjHpClB,EAiHoCM,KAAK+B,GAASjB,EAAEd,KAAKK,OAC3DoB,eAAeY,QAAQzB,EAlHrBlB,EAkHqBM,KAAK2B,GAAQb,EAAEd,KAAKK,MAC7C,CAAC,SAAAY,IAGCW,SAASC,gBAAgBS,gBAAgB1B,EAtHvClB,EAsHuCM,KAAK+B,GAASjB,GACvDW,eAAec,WAAW3B,EAvHxBlB,EAuHwBM,KAAK2B,GAAQb,EACzC,CAEA,SAAAM,IAIEoB,OAAOC,YAAY,CAAEC,GAAI1C,KAAK2C,IAAM,IACtC,CAtBCC,EAzGGlD,EA+HH,IAAAiC,EAAA,CAAAb,EA9HiB,QAAMiB,EAAA,CAAAjB,EACL,aAAWD,EAAA,CAAAC,EACV0B,OAAOK,WAAW,iCAA+BpC,EAHjEf,EAAK,cAIYkC,SAASC,gBAAgBiB,aAAalC,EAJvDlB,EAAKkD,EAIuDb,GAASjB,IA8H3EpB,EAAMqD"}