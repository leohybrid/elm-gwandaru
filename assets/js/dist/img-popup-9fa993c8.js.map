{"version":3,"file":"img-popup-9fa993c8.js","sources":["../../../_javascript/modules/components/clipboard.js","../../../_javascript/modules/components/img-popup.js"],"sourcesContent":["/**\r\n * Clipboard functions\r\n *\r\n * Dependencies:\r\n *    clipboard.js (https://github.com/zenorocha/clipboard.js)\r\n */\r\n\r\nimport Tooltip from 'bootstrap/js/src/tooltip';\r\n\r\nconst clipboardSelector = '.code-header>button';\r\n\r\nconst ICON_DEFAULT = 'far fa-clipboard';\r\nconst ICON_SUCCESS = 'fas fa-check';\r\n\r\nconst ATTR_TIMEOUT = 'timeout';\r\nconst ATTR_TITLE_SUCCEED = 'data-title-succeed';\r\nconst ATTR_TITLE_ORIGIN = 'data-bs-original-title';\r\nconst TIMEOUT = 2000; // in milliseconds\r\n\r\nfunction isLocked(node) {\r\n  if (node.hasAttribute(ATTR_TIMEOUT)) {\r\n    let timeout = node.getAttribute(ATTR_TIMEOUT);\r\n    if (Number(timeout) > Date.now()) {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction lock(node) {\r\n  node.setAttribute(ATTR_TIMEOUT, Date.now() + TIMEOUT);\r\n}\r\n\r\nfunction unlock(node) {\r\n  node.removeAttribute(ATTR_TIMEOUT);\r\n}\r\n\r\nfunction showTooltip(btn) {\r\n  const succeedTitle = btn.getAttribute(ATTR_TITLE_SUCCEED);\r\n  btn.setAttribute(ATTR_TITLE_ORIGIN, succeedTitle);\r\n  Tooltip.getInstance(btn).show();\r\n}\r\n\r\nfunction hideTooltip(btn) {\r\n  Tooltip.getInstance(btn).hide();\r\n  btn.removeAttribute(ATTR_TITLE_ORIGIN);\r\n}\r\n\r\nfunction setSuccessIcon(btn) {\r\n  const icon = btn.children[0];\r\n  icon.setAttribute('class', ICON_SUCCESS);\r\n}\r\n\r\nfunction resumeIcon(btn) {\r\n  const icon = btn.children[0];\r\n  icon.setAttribute('class', ICON_DEFAULT);\r\n}\r\n\r\nfunction setCodeClipboard() {\r\n  const clipboardList = document.querySelectorAll(clipboardSelector);\r\n\r\n  if (clipboardList.length === 0) {\r\n    return;\r\n  }\r\n\r\n  // Initial the clipboard.js object\r\n  const clipboard = new ClipboardJS(clipboardSelector, {\r\n    target: (trigger) => {\r\n      const codeBlock = trigger.parentNode.nextElementSibling;\r\n      return codeBlock.querySelector('code .rouge-code');\r\n    }\r\n  });\r\n\r\n  [...clipboardList].map(\r\n    (elem) =>\r\n      new Tooltip(elem, {\r\n        placement: 'left'\r\n      })\r\n  );\r\n\r\n  clipboard.on('success', (e) => {\r\n    const trigger = e.trigger;\r\n\r\n    e.clearSelection();\r\n\r\n    if (isLocked(trigger)) {\r\n      return;\r\n    }\r\n\r\n    setSuccessIcon(trigger);\r\n    showTooltip(trigger);\r\n    lock(trigger);\r\n\r\n    setTimeout(() => {\r\n      hideTooltip(trigger);\r\n      resumeIcon(trigger);\r\n      unlock(trigger);\r\n    }, TIMEOUT);\r\n  });\r\n}\r\n\r\nfunction setLinkClipboard() {\r\n  const btnCopyLink = document.getElementById('copy-link');\r\n\r\n  if (btnCopyLink === null) {\r\n    return;\r\n  }\r\n\r\n  btnCopyLink.addEventListener('click', (e) => {\r\n    const target = e.target;\r\n\r\n    if (isLocked(target)) {\r\n      return;\r\n    }\r\n\r\n    // Copy URL to clipboard\r\n    navigator.clipboard.writeText(window.location.href).then(() => {\r\n      const defaultTitle = target.getAttribute(ATTR_TITLE_ORIGIN);\r\n      const succeedTitle = target.getAttribute(ATTR_TITLE_SUCCEED);\r\n\r\n      // Switch tooltip title\r\n      target.setAttribute(ATTR_TITLE_ORIGIN, succeedTitle);\r\n      Tooltip.getInstance(target).show();\r\n\r\n      lock(target);\r\n\r\n      setTimeout(() => {\r\n        target.setAttribute(ATTR_TITLE_ORIGIN, defaultTitle);\r\n        unlock(target);\r\n      }, TIMEOUT);\r\n    });\r\n  });\r\n\r\n  btnCopyLink.addEventListener('mouseleave', (e) => {\r\n    Tooltip.getInstance(e.target).hide();\r\n  });\r\n}\r\n\r\nexport function initClipboard() {\r\n  setCodeClipboard();\r\n  setLinkClipboard();\r\n}\r\n","/**\r\n * Set up image popup\r\n *\r\n * Dependencies: https://github.com/biati-digital/glightbox\r\n */\r\n\r\nconst lightImages = '.popup:not(.dark)';\r\nconst darkImages = '.popup:not(.light)';\r\nlet selector = lightImages;\r\n\r\nfunction updateImages(current, reverse) {\r\n  if (selector === lightImages) {\r\n    selector = darkImages;\r\n  } else {\r\n    selector = lightImages;\r\n  }\r\n\r\n  if (reverse === null) {\r\n    reverse = GLightbox({ selector: `${selector}` });\r\n  }\r\n\r\n  [current, reverse] = [reverse, current];\r\n}\r\n\r\nexport function imgPopup() {\r\n  if (document.querySelector('.popup') === null) {\r\n    return;\r\n  }\r\n\r\n  const hasDualImages = !(\r\n    document.querySelector('.popup.light') === null &&\r\n    document.querySelector('.popup.dark') === null\r\n  );\r\n\r\n  if (Theme.visualState === Theme.DARK) {\r\n    selector = darkImages;\r\n  }\r\n\r\n  let current = GLightbox({ selector: `${selector}` });\r\n\r\n  if (hasDualImages && Theme.switchable) {\r\n    let reverse = null;\r\n\r\n    window.addEventListener('message', (event) => {\r\n      if (event.source === window && event.data && event.data.id === Theme.ID) {\r\n        updateImages(current, reverse);\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"names":["clipboardSelector","ATTR_TIMEOUT","ATTR_TITLE_SUCCEED","ATTR_TITLE_ORIGIN","TIMEOUT","isLocked","node","hasAttribute","timeout","getAttribute","Number","Date","now","lock","setAttribute","unlock","removeAttribute","setCodeClipboard","clipboardList","document","querySelectorAll","length","clipboard","ClipboardJS","target","trigger","parentNode","nextElementSibling","querySelector","_toConsumableArray","map","elem","Tooltip","placement","on","e","clearSelection","children","btn","succeedTitle","getInstance","show","showTooltip","setTimeout","hide","hideTooltip","resumeIcon","initClipboard","btnCopyLink","getElementById","addEventListener","navigator","writeText","window","location","href","then","defaultTitle","lightImages","darkImages","selector","imgPopup","hasDualImages","Theme","visualState","DARK","current","GLightbox","concat","switchable","event","source","data","id","ID","reverse","_ref","updateImages"],"mappings":"oGASA,IAAMA,EAAoB,sBAKpBC,EAAe,UACfC,EAAqB,qBACrBC,EAAoB,yBACpBC,EAAU,IAEhB,SAASC,EAASC,GAChB,GAAIA,EAAKC,aAAaN,GAAe,CACnC,IAAIO,EAAUF,EAAKG,aAAaR,GAChC,GAAIS,OAAOF,GAAWG,KAAKC,MACzB,OAAO,CAEX,CAEA,OAAO,CACT,CAEA,SAASC,EAAKP,GACZA,EAAKQ,aAAab,EAAcU,KAAKC,MAAQR,EAC/C,CAEA,SAASW,EAAOT,GACdA,EAAKU,gBAAgBf,EACvB,CAuBA,SAASgB,IACP,IAAMC,EAAgBC,SAASC,iBAAiBpB,GAEhD,GAA6B,IAAzBkB,EAAcG,OAAlB,CAKA,IAAMC,EAAY,IAAIC,YAAYvB,EAAmB,CACnDwB,OAAQ,SAACC,GAEP,OADkBA,EAAQC,WAAWC,mBACpBC,cAAc,mBACjC,IAGFC,EAAIX,GAAeY,IACjB,SAACC,GAAI,OACH,IAAIC,EAAQD,EAAM,CAChBE,UAAW,QACX,GAGNX,EAAUY,GAAG,UAAW,SAACC,GACvB,IAAMV,EAAUU,EAAEV,SAElBU,EAAEC,iBAEE/B,EAASoB,MAIEA,EAxCAY,SAAS,GACrBvB,aAAa,QAvCC,gBA0BrB,SAAqBwB,GACnB,IAAMC,EAAeD,EAAI7B,aAAaP,GACtCoC,EAAIxB,aAAaX,EAAmBoC,GACpCP,EAAQQ,YAAYF,GAAKG,MAC3B,CAiDIC,CAAYjB,GACZZ,EAAKY,GAELkB,WAAW,YAlDf,SAAqBL,GACnBN,EAAQQ,YAAYF,GAAKM,OACzBN,EAAItB,gBAAgBb,EACtB,CAgDM0C,CAAYpB,GAzClB,SAAoBa,GACLA,EAAID,SAAS,GACrBvB,aAAa,QA7CC,mBA8CrB,CAuCMgC,CAAWrB,GACXV,EAAOU,EACR,EAAErB,GACL,EAnCA,CAoCF,CAuCO,SAAS2C,IArChB,IACQC,EAqCN/B,IAnCoB,QAFd+B,EAAc7B,SAAS8B,eAAe,gBAM5CD,EAAYE,iBAAiB,QAAS,SAACf,GACrC,IAAMX,EAASW,EAAEX,OAEbnB,EAASmB,IAKb2B,UAAU7B,UAAU8B,UAAUC,OAAOC,SAASC,MAAMC,KAAK,WACvD,IAAMC,EAAejC,EAAOf,aAAaN,GACnCoC,EAAef,EAAOf,aAAaP,GAGzCsB,EAAOV,aAAaX,EAAmBoC,GACvCP,EAAQQ,YAAYhB,GAAQiB,OAE5B5B,EAAKW,GAELmB,WAAW,WACTnB,EAAOV,aAAaX,EAAmBsD,GACvC1C,EAAOS,EACR,EAAEpB,EACL,EACF,GAEA4C,EAAYE,iBAAiB,aAAc,SAACf,GAC1CH,EAAQQ,YAAYL,EAAEX,QAAQoB,MAChC,GAMF,CCxIA,IAAMc,EAAc,oBACdC,EAAa,qBACfC,EAAWF,EAgBR,SAASG,IACd,GAAyC,OAArC1C,SAASS,cAAc,UAA3B,CAIA,IAAMkC,IACuC,OAA3C3C,SAASS,cAAc,iBACmB,OAA1CT,SAASS,cAAc,gBAGrBmC,MAAMC,cAAgBD,MAAME,OAC9BL,EAAWD,GAGb,IAAIO,EAAUC,UAAU,CAAEP,SAAQ,GAAAQ,OAAKR,KAEvC,GAAIE,GAAiBC,MAAMM,WAAY,CAGrChB,OAAOH,iBAAiB,UAAW,SAACoB,GAC9BA,EAAMC,SAAWlB,QAAUiB,EAAME,MAAQF,EAAME,KAAKC,KAAOV,MAAMW,IAlC3E,SAAsBR,EAASS,GAE3Bf,EADEA,IAAaF,EACJC,EAEAD,EAGG,OAAZiB,IACFA,EAAUR,UAAU,CAAEP,SAAQ,GAAAQ,OAAKR,MACpC,IAAAgB,EAEoB,CAACD,EAAST,GAA9BA,EAAOU,EAAA,GAAED,EAAOC,EAAA,EACnB,CAuBQC,CAAaX,EAJH,KAMd,EACF,CArBA,CAsBF"}