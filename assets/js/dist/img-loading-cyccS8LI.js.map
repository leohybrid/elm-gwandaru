{"version":3,"file":"img-loading-cyccS8LI.js","sources":["../../../_javascript/modules/components/img-loading.js"],"sourcesContent":["/**\r\n * Setting up image lazy loading and LQIP switching\r\n */\r\n\r\nconst ATTR_DATA_SRC = 'data-src';\r\nconst ATTR_DATA_LQIP = 'data-lqip';\r\n\r\nconst cover = {\r\n  SHIMMER: 'shimmer',\r\n  BLUR: 'blur'\r\n};\r\n\r\nfunction removeCover(clzss) {\r\n  this.parentElement.classList.remove(clzss);\r\n}\r\n\r\nfunction handleImage() {\r\n  if (!this.complete) {\r\n    return;\r\n  }\r\n\r\n  if (this.hasAttribute(ATTR_DATA_LQIP)) {\r\n    removeCover.call(this, cover.BLUR);\r\n  } else {\r\n    removeCover.call(this, cover.SHIMMER);\r\n  }\r\n}\r\n\r\n/**\r\n * Switches the LQIP with the real image URL.\r\n */\r\nfunction switchLQIP() {\r\n  const src = this.getAttribute(ATTR_DATA_SRC);\r\n  this.setAttribute('src', encodeURI(src));\r\n  this.removeAttribute(ATTR_DATA_SRC);\r\n}\r\n\r\nexport function loadImg() {\r\n  const images = document.querySelectorAll('article img');\r\n\r\n  if (images.length === 0) {\r\n    return;\r\n  }\r\n\r\n  images.forEach((img) => {\r\n    img.addEventListener('load', handleImage);\r\n  });\r\n\r\n  // Images loaded from the browser cache do not trigger the 'load' event\r\n  document.querySelectorAll('article img[loading=\"lazy\"]').forEach((img) => {\r\n    if (img.complete) {\r\n      removeCover.call(img, cover.SHIMMER);\r\n    }\r\n  });\r\n\r\n  // LQIPs set by the data URI or WebP will not trigger the 'load' event,\r\n  // so manually convert the URI to the URL of a high-resolution image.\r\n  const lqips = document.querySelectorAll(\r\n    `article img[${ATTR_DATA_LQIP}=\"true\"]`\r\n  );\r\n\r\n  if (lqips.length) {\r\n    lqips.forEach((lqip) => {\r\n      switchLQIP.call(lqip);\r\n    });\r\n  }\r\n}\r\n"],"names":["ATTR_DATA_SRC","ATTR_DATA_LQIP","cover","removeCover","clzss","this","parentElement","classList","remove","handleImage","complete","hasAttribute","call","switchLQIP","src","getAttribute","setAttribute","encodeURI","removeAttribute","loadImg","images","document","querySelectorAll","length","forEach","img","addEventListener","lqips","concat","lqip"],"mappings":"AAIA,IAAMA,EAAgB,WAChBC,EAAiB,YAEjBC,EACK,UADLA,EAEE,OAGR,SAASC,EAAYC,GACnBC,KAAKC,cAAcC,UAAUC,OAAOJ,EACtC,CAEA,SAASK,IACFJ,KAAKK,WAINL,KAAKM,aAAaV,GACpBE,EAAYS,KAAKP,KAAMH,GAEvBC,EAAYS,KAAKP,KAAMH,GAE3B,CAKA,SAASW,IACP,IAAMC,EAAMT,KAAKU,aAAaf,GAC9BK,KAAKW,aAAa,MAAOC,UAAUH,IACnCT,KAAKa,gBAAgBlB,EACvB,CAEO,SAASmB,IACd,IAAMC,EAASC,SAASC,iBAAiB,eAEzC,GAAsB,IAAlBF,EAAOG,OAAX,CAIAH,EAAOI,QAAQ,SAACC,GACdA,EAAIC,iBAAiB,OAAQjB,EAC/B,GAGAY,SAASC,iBAAiB,+BAA+BE,QAAQ,SAACC,GAC5DA,EAAIf,UACNP,EAAYS,KAAKa,EAAKvB,EAE1B,GAIA,IAAMyB,EAAQN,SAASC,gCAAgBM,OACtB3B,EAAc,aAG3B0B,EAAMJ,QACRI,EAAMH,QAAQ,SAACK,GACbhB,EAAWD,KAAKiB,EAClB,EAtBF,CAwBF"}