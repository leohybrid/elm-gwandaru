{"version":3,"file":"sw.min.js","sources":["../../../_javascript/pwa/sw.js"],"sourcesContent":["importScripts('./assets/js/data/swconf.js');\r\n\r\nconst purge = swconf.purge;\r\nconst interceptor = swconf.interceptor;\r\n\r\nfunction verifyUrl(url) {\r\n  const requestUrl = new URL(url);\r\n  const requestPath = requestUrl.pathname;\r\n\r\n  if (!requestUrl.protocol.startsWith('http')) {\r\n    return false;\r\n  }\r\n\r\n  for (const prefix of interceptor.urlPrefixes) {\r\n    if (requestUrl.href.startsWith(prefix)) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  for (const path of interceptor.paths) {\r\n    if (requestPath.startsWith(path)) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nself.addEventListener('install', (event) => {\r\n  if (purge) {\r\n    return;\r\n  }\r\n\r\n  event.waitUntil(\r\n    caches.open(swconf.cacheName).then((cache) => {\r\n      return cache.addAll(swconf.resources);\r\n    })\r\n  );\r\n});\r\n\r\nself.addEventListener('activate', (event) => {\r\n  event.waitUntil(\r\n    caches.keys().then((keyList) => {\r\n      return Promise.all(\r\n        keyList.map((key) => {\r\n          if (purge) {\r\n            return caches.delete(key);\r\n          } else {\r\n            if (key !== swconf.cacheName) {\r\n              return caches.delete(key);\r\n            }\r\n          }\r\n        })\r\n      );\r\n    })\r\n  );\r\n});\r\n\r\nself.addEventListener('message', (event) => {\r\n  if (event.data === 'SKIP_WAITING') {\r\n    self.skipWaiting();\r\n  }\r\n});\r\n\r\nself.addEventListener('fetch', (event) => {\r\n  if (event.request.headers.has('range')) {\r\n    return;\r\n  }\r\n\r\n  event.respondWith(\r\n    caches.match(event.request).then((response) => {\r\n      if (response) {\r\n        return response;\r\n      }\r\n\r\n      return fetch(event.request).then((response) => {\r\n        const url = event.request.url;\r\n\r\n        if (purge || event.request.method !== 'GET' || !verifyUrl(url)) {\r\n          return response;\r\n        }\r\n\r\n        // See: <https://developers.google.com/web/fundamentals/primers/service-workers#cache_and_return_requests>\r\n        let responseToCache = response.clone();\r\n\r\n        caches.open(swconf.cacheName).then((cache) => {\r\n          cache.put(event.request, responseToCache);\r\n        });\r\n        return response;\r\n      });\r\n    })\r\n  );\r\n});\r\n"],"names":["importScripts","purge","swconf","interceptor","self","addEventListener","event","waitUntil","caches","open","cacheName","then","cache","addAll","resources","keys","keyList","Promise","all","map","key","data","skipWaiting","request","headers","has","respondWith","match","response","fetch","url","method","requestUrl","URL","requestPath","pathname","protocol","startsWith","_step","_iterator","_createForOfIteratorHelper","urlPrefixes","s","n","done","prefix","value","href","err","e","f","_step2","_iterator2","paths","path","verifyUrl","responseToCache","clone","put"],"mappings":"4DAAAA,cAAc,8BAEd,IAAMC,EAAQC,OAAOD,MACfE,EAAcD,OAAOC,YAwB3BC,KAAKC,iBAAiB,UAAW,SAACC,GAC5BL,GAIJK,EAAMC,UACJC,OAAOC,KAAKP,OAAOQ,WAAWC,KAAK,SAACC,GAClC,OAAOA,EAAMC,OAAOX,OAAOY,UAC7B,GAEJ,GAEAV,KAAKC,iBAAiB,WAAY,SAACC,GACjCA,EAAMC,UACJC,OAAOO,OAAOJ,KAAK,SAACK,GAClB,OAAOC,QAAQC,IACbF,EAAQG,IAAI,SAACC,GACX,OAAInB,GAGEmB,IAAQlB,OAAOQ,UAFZF,OAAM,OAAQY,QAErB,CAIJ,GAEJ,GAEJ,GAEAhB,KAAKC,iBAAiB,UAAW,SAACC,GACb,iBAAfA,EAAMe,MACRjB,KAAKkB,aAET,GAEAlB,KAAKC,iBAAiB,QAAS,SAACC,GAC1BA,EAAMiB,QAAQC,QAAQC,IAAI,UAI9BnB,EAAMoB,YACJlB,OAAOmB,MAAMrB,EAAMiB,SAASZ,KAAK,SAACiB,GAChC,OAAIA,GAIGC,MAAMvB,EAAMiB,SAASZ,KAAK,SAACiB,GAChC,IAAME,EAAMxB,EAAMiB,QAAQO,IAE1B,GAAI7B,GAAkC,QAAzBK,EAAMiB,QAAQQ,SAxEnC,SAAmBD,GACjB,IAAME,EAAa,IAAIC,IAAIH,GACrBI,EAAcF,EAAWG,SAE/B,IAAKH,EAAWI,SAASC,WAAW,QAClC,OAAO,EACR,IAE2CC,EAF3CC,EAAAC,EAEoBrC,EAAYsC,aAAW,IAA5C,IAAAF,EAAAG,MAAAJ,EAAAC,EAAAI,KAAAC,MAA8C,CAAA,IAAnCC,EAAMP,EAAAQ,MACf,GAAId,EAAWe,KAAKV,WAAWQ,GAC7B,OAAO,CAEX,CAAC,CAAA,MAAAG,GAAAT,EAAAU,EAAAD,EAAA,CAAA,QAAAT,EAAAW,GAAA,CAAA,IAEmCC,EAFnCC,EAAAZ,EAEkBrC,EAAYkD,OAAK,IAApC,IAAAD,EAAAV,MAAAS,EAAAC,EAAAT,KAAAC,MAAsC,CAAA,IAA3BU,EAAIH,EAAAL,MACb,GAAIZ,EAAYG,WAAWiB,GACzB,OAAO,CAEX,CAAC,CAAA,MAAAN,GAAAI,EAAAH,EAAAD,EAAA,CAAA,QAAAI,EAAAF,GAAA,CACD,OAAO,CACT,CAoDwDK,CAAUzB,GACxD,OAAOF,EAIT,IAAI4B,EAAkB5B,EAAS6B,QAK/B,OAHAjD,OAAOC,KAAKP,OAAOQ,WAAWC,KAAK,SAACC,GAClCA,EAAM8C,IAAIpD,EAAMiB,QAASiC,EAC3B,GACO5B,CACT,EACF,GAEJ"}